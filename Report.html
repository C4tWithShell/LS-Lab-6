<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        LS Lab 6 - Fault Tolerant and High Available Storage &amp; Backup - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important;position:relative}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p:last-child{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit;overflow:visible}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p:last-child,.markdown-body .alert>ul:last-child{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.figma{display:table;position:relative;width:100%;padding-bottom:56.25%}.figma iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%;border:1px solid #eee}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{height:40px;padding:10px 4px;border-top-left-radius:0;border-bottom-left-radius:0}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:20px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:50%;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;text-decoration:none;padding-left:22px}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em;font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true"><h1 id="LS-Lab-6---Fault-Tolerant-and-High-Available-Storage-amp-Backup" data-id="LS-Lab-6---Fault-Tolerant-and-High-Available-Storage-amp-Backup" data-original-title="" title=""><a class="anchor hidden-xs" href="#LS-Lab-6---Fault-Tolerant-and-High-Available-Storage-amp-Backup" title="LS-Lab-6---Fault-Tolerant-and-High-Available-Storage-amp-Backup"><span class="octicon octicon-link"></span></a><span>LS Lab 6 - Fault Tolerant and High Available Storage &amp; Backup</span></h1><p><strong><span>Name: Vladimir Shelkovnikov</span></strong></p><hr><center>
<h2 id="Section-1---Fault-Tolerant-Storage" data-id="Section-1---Fault-Tolerant-Storage"><a class="anchor hidden-xs" href="#Section-1---Fault-Tolerant-Storage" title="Section-1---Fault-Tolerant-Storage"><span class="octicon octicon-link"></span></a><span>Section 1 - Fault Tolerant Storage</span></h2>
<hr>
</center><h2 id="Task-1---Take-a-pick" data-id="Task-1---Take-a-pick"><a class="anchor hidden-xs" href="#Task-1---Take-a-pick" title="Task-1---Take-a-pick"><span class="octicon octicon-link"></span></a><span>Task 1 - Take a pick</span></h2><div class="alert alert-success">
<ol>
<li><span>Briefly describe and explain the difference between block storage, file storage, and object storage.</span></li>
<li><span>Take a pick from the list proposed below:</span></li>
</ol>
<ul>
<li><span>DRBD (preferred option)</span></li>
<li><span>Ceph block device</span></li>
<li><span>Gluster block device</span></li>
<li><span>FreeBSD HAST (if you’re familiar with *BSD)</span></li>
<li><span>does anything else exist as for BDs?</span></li>
</ul>
</div><hr><blockquote>
<p><span>Block storage</span></p>
<blockquote>
<p><span>Block storage chops data into blocks and stores them as separate pieces.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<p><span>File storage</span></p>
<blockquote>
<p><span>File storage is good for organized, structured data. Data is stored as a single piece of information inside a folder. Locating data in a file storage system requires knowing where it falls in the hierarchy. This can take time when a file system is large. File-based storage systems must scale out by adding more systems, rather than scale up by adding more capacity.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<p><span>Object storage</span></p>
<blockquote>
<p><span>Object storage, also known as object-based storage, is a flat structure in which files are broken into pieces and spread out among hardware. There are no folders like in file storage. Additionally, object storage does not store all data together in a single file.</span></p>
</blockquote>
</blockquote><hr><p><span>So we can divide them into the following categories:</span></p><ul>
<li><span>Cost: block and file storage are higher, object storage is cheaper for high volumes of data.</span></li>
<li><span>Management ease: The metadata and searchability make object storage a top choice for high volumes of data. File storage, with its hierarchical organization system, is more appropriate for lower volumes of data.</span></li>
<li><span>Volume: object or block storage.</span></li>
<li><span>Retrievability: file and object storage are typically easier to access.</span></li>
<li><span>Handling of metadata: best served by object storage, basic metadata for file storage.</span></li>
</ul><p><span>This lab I decided to do with </span><strong><span>DRBD</span></strong><span>.</span></p><hr><h2 id="Task-2---Fault-tolerant-setup" data-id="Task-2---Fault-tolerant-setup"><a class="anchor hidden-xs" href="#Task-2---Fault-tolerant-setup" title="Task-2---Fault-tolerant-setup"><span class="octicon octicon-link"></span></a><span>Task 2 - Fault tolerant setup</span></h2><div class="alert alert-success">
<ol>
<li><span>Create and configure a necessary amount of VMs for your option. Install necessary packets and then configure a distributed block device.</span></li>
<li><span>Check (for all VMs) that a new block device appeared in the system and format it with the usual filesystem like EXT4 or XFS and then mount. Make sure that each VM can recognize a filesystem on distributed block device.</span></li>
<li><span>Validate that storage on your distributed block device is fault tolerant (create some data, destroy one node, check storage status, etc.).</span></li>
<li><span>Have you lost your data after destroying one node? Was it necessary to do something on another nodes to get the data?</span></li>
</ol>
</div><p><span>Figure 1 shows the network topology.</span></p><center>
<p><img src="https://i.imgur.com/lx4EpRc.png" alt="" loading="lazy"><br>
<span>Figure 1 - Network topology</span></p>
</center><p><span>Here I used 2 VM. Each of them has a second 2GB disk for DRBD. I modified the </span><strong><span>/etc/hosts</span></strong><span> file at each VM as shown in Figure 2.</span></p><center>
<p><img src="https://i.imgur.com/N7ltGcc.png" alt="" loading="lazy"><br>
<span>Figure 2 - /etc/hosts</span></p>
</center><p><span>I added DRBD from the PPA </span><code>sudo apt-add-repository ppa:linbit/linbit-drbd9-stack</code><span>.</span><br>
<span>Also, I install necessary packages using the command </span><code>sudo apt install drbd-utils drbd-dkms</code><span>.</span></p><p><span>Then I need to configure it. I changed </span><code>/etc/drbd.d/global_common.conf</code><span> as shown below:</span></p><pre><code>global {
  usage-count yes;
}
common{
  net{
    protocol C;
  }
}
</code></pre><div class="alert alert-info">
<p><code>usage-count yes</code><span> - sending a notice to the DRBD team each time a new version of the software is installed in your system.</span></p>
<p><code>protocol C</code><span> - the DRBD resource uses a fully synchronous replication.</span></p>
</div><p><span>I create DRBD resourse - </span><code>sudo nano /etc/drbd.d/drbd.res</code><span> as shown below:</span></p><pre><code>resource drbd {
  device /dev/drbd0;
  disk /dev/vdb;
  meta-disk internal;
  
  on drbd-1 {
    address 10.1.1.76:7789;
  }

  on drbd-2 {
    address 10.1.1.45:7789;
  }
}
</code></pre><div class="alert alert-info">
<p><span>device /dev/drbd0 — uses </span><strong><span>/dev/drbd0</span></strong><span> as path to drbd volume.</span><br>
<span>disk /dev/vdb1 — uses disk </span><strong><span>/dev/vdb1</span></strong><span>.</span><br>
<span>meta-disk internal — uses same block device as meta data storage.</span></p>
</div><p><span>This configuration is the same for both VMs. After that, I initialize the device using the command </span><code>sudo drbdadm create-md drbd</code><span>. So the vdb disk becomes drbd (FSTYPE) as shown in Figure 3.</span></p><center>
<p><img src="https://i.imgur.com/wAwWUcT.png" alt="" loading="lazy"><br>
<span>Figure 3 - drbd disk</span></p>
</center><p><span>Next, I need to run it to connect the resource to its backup device - </span><code>sudo drbdadm up drbd</code><span>. Now, if I run the </span><code>lsblk</code><span> command I will see that device DRBD </span><strong><span>drbd0</span></strong><span> is connected to the backup device </span><strong><span>/dev/vdb</span></strong><span> (Figure 4).</span></p><center>
<p><img src="https://i.imgur.com/YHNYZyl.png" alt="" loading="lazy"><br>
<span>Figure 4 -Device drbd0</span></p>
</center><p><span>At this stage, DRBD is already ready to work. Now I need to specify which node should be used as the source of initial device synchronization. I choose </span><strong><span>drbd-1</span></strong><span> as the initial device so I run:</span></p><pre><code>sudo drbdadm primary --force drbd
drbdadm status drbd
</code></pre><p><span>Figure 5 shows that </span><strong><span>drbd-1</span></strong><span> is primary, while </span><strong><span>drbd-2</span></strong><span> is a secondary disk device.</span></p><center>
<p><img src="https://i.imgur.com/2Sulnts.png" alt="" loading="lazy"><br>
<span>Figure 5 - drbd status</span></p>
</center><p><span>Now I have to create a filesystem on the device (Figures 6 and 7) and mount it to check if I can use it to store replicated data:</span></p><pre><code>// Creating ext4 filesystem on drbd0 device
sudo mkfs -t ext4 /dev/drbd0
// Creating mount directory
sudo mkdir /mnt/drbd
// Mount
sudo mount /dev/drbd0 /mnt/drbd
//Create file
sudo nano test
</code></pre><center>
<p><img src="https://i.imgur.com/sZBNA7k.png" alt="" loading="lazy"><br>
<span>Figure 6 - Creating ext4 filesystem on drbd0 device</span></p>
<p><img src="https://i.imgur.com/Gvu2h6w.png" alt="" loading="lazy"><br>
<span>Figure 7 - VM can recognize the filesystem on the device</span></p>
</center><p><span>Then I destroyed the </span><strong><span>drbd-1</span></strong><span> node. Now let’s get data on the second node. To do this. I need to run the following command:</span></p><pre><code>// Make drbd-2 primary
sudo drbdadm primary drbd
// Mount device
sudo mount /dev/drbd0 /mnt/drbd/
// Go to the folder
cd /mnt/drbd
// Check the files (Figure 8)
ll
</code></pre><center>
<p><img src="https://i.imgur.com/6ADe7sr.png" alt="" loading="lazy"><br>
<span>Figure 8 - Files on second VM</span></p>
</center><hr><h2 id="Task-3---High-Available-setup" data-id="Task-3---High-Available-setup"><a class="anchor hidden-xs" href="#Task-3---High-Available-setup" title="Task-3---High-Available-setup"><span class="octicon octicon-link"></span></a><span>Task 3 - High Available setup</span></h2><div class="alert alert-success">
<ol>
<li><span>Modify your configuration to make storage high available. Besides it, you will need to format your block device with a clustered filesystem (e.g., OCFS2, GlusterFS, MooseFS).</span></li>
<li><span>Again validate the storage on your distributed block device.</span></li>
<li><span>Was it necessary to do something on another nodes to get the data in this setup?</span></li>
</ol>
</div><p><span>For HA setup I will change the configuration to Primary/Primary and will use OCFS2 as a filesystem.</span></p><p><span>I install nessesary packages - </span><code>sudo apt install ocfs2-tools linux-modules-extra-5.4.0-62-generic</code><span>.</span></p><p><span>Then, I set up global configuration:</span></p><pre data-original-title="" title=""><code>...
startup {
  become-primary-on both;
}
net {
  allow-two-primaries;
  after-sb-0pri discard-zero-changes;
  after-sb-1pri discard-secondary;
  after-sb-2pri disconnect;
}
</code></pre><div class="alert alert-info">
<p><strong><span>allow-two-primaries</span></strong><span> is an important option that allows accepting changes on two primary servers;</span><br>
<strong><span>become-primary-on both</span></strong><span> - sets both nodes to primary.</span><br>
<strong><span>after-sb-0pri, after-sb-1pri, after-sb-2pri</span></strong><span> are options responsible for node actions when splitbrain is detected.</span><br>
<strong><span>after-sb-0pri</span></strong><span> - the resource is not in the Primary role on any host.</span><br>
<strong><span>discard-zero-changes</span></strong><span> - if there is any host on which no changes occurred at all, simply apply all modifications made on the other and continue.</span><br>
<strong><span>after-sb-1pri</span></strong><span> - the resource is in the Primary role on one host.</span><br>
<strong><span>discard-secondary</span></strong><span> - secondary role is the split brain victim.</span><br>
<strong><span>after-sb-2pri</span></strong><span> - the resource is in the Primary role on both hosts.</span><br>
<strong><span>disconnect</span></strong><span> - drop the connection and continue in disconnected mode.</span></p>
</div><p><span>Resource configuration is also changed a little bit (Figure 9). I create a new resource by simply copying the configuration file - </span><code>sudo cp /etc/drbd.d/drbd.res /etc/drbd.d/drbd-ha.res</code><span>. Also, I moved the old config file from the drbd.d directory.</span></p><center>
<p><img src="https://i.imgur.com/MYq97Fb.png" alt="" loading="lazy"><br>
<span>Figure 9 - </span><code>/etc/drbd.d/drbd-ha.res</code></p>
</center><p><span>Then I initialized it:</span></p><pre><code>sudo drbdadm create-md drbd-ha
sudo drbdadm up drbd-ha
// On the first node I started to sync
sudo drbdadm primary --force drbd-ha
// Then on the second
sudo drbdadm primary --force drbd-ha
</code></pre><p><span>Figure 10 shows the status.</span></p><center>
<p><img src="https://i.imgur.com/2Z8dQBV.png" alt="" loading="lazy"><br>
<span>Figure 10 - DRBD status</span></p>
</center><p><span>So both of nodes are primary and syncronized. Let’s move on to the ocfs2. For both nodes I created configuration file - </span><code>/etc/ocfs2/cluster.conf</code><span>:</span></p><pre><code>cluster:
     node_count = 2
     name = ls6       

node:
     number = 1
     cluster = ls6         
     ip_port = 7777
     ip_address = 10.1.1.76   
     name = drbd-1

node:
     number = 2
     cluster = ls6         
     ip_port = 7777
     ip_address = 10.1.1.45 
     name = drbd-2
</code></pre><p><span>From drbd-1 I created a filesystem using the command </span><code>sudo mkfs.ocfs2 -L "ls6Task3" /dev/drbd1</code><span>. Then I changed the file </span><code>/etc/default/02cb</code><span> by adding changing following lines:</span></p><pre><code>O2CB_ENABLED=true 
O2CB_BOOTCLUSTER=ls6
</code></pre><p><span>Then on each of the nodes, I run </span><code>sudo o2cb register-cluster ls6</code><span> to initialize the cluster. Create directory to mount - </span><code>sudo mkdir /media/shared</code><span> and mount the device - </span><code>sudo mount /dev/drbd1 /media/shared</code><span>.</span><br>
<span>I created a file </span><strong><span>test</span></strong><span> on drbd-1 - </span><code>nano test</code><span> (Figure 11)</span></p><center>
<p><img src="https://i.imgur.com/gqcqmb6.png" alt="" loading="lazy"><br>
<span>Figure 11 - drdb-1 files</span></p>
</center><p><span>After that, I destroyed the drbd-1 node and look at the </span><strong><span>/media/shared</span></strong><span> directory at the drbd-2 node (Figure 12).</span></p><center>
<p><img src="https://i.imgur.com/97mytRF.png" alt="" loading="lazy"><br>
<span>Figure 12 - drbd-2 files</span></p>
</center><p><span>No extra actions are needed.</span></p><p><span>I created a new file as shown in Figure 13</span></p><center>
<p><img src="https://i.imgur.com/u1rfelQ.png" alt="" loading="lazy"><br>
<span>Figure 13 - new file is created</span></p>
</center><p><span>I started the node and mounted the folder, so I can see the created file (Figure 14).</span></p><center>
<p><img src="https://i.imgur.com/gLL3JM2.png" alt="" loading="lazy"><br>
<span>Figure 14 - Changes</span></p>
</center><hr><h1 id="Task-4---Questions" data-id="Task-4---Questions"><a class="anchor hidden-xs" href="#Task-4---Questions" title="Task-4---Questions"><span class="octicon octicon-link"></span></a><span>Task 4 - Questions</span></h1><hr><blockquote>
<p><span>Explain what is fault tolerance and high availability?</span></p>
<blockquote>
<p><span>Fault tolerance (FT) is a form of redundancy, enabling visitors to access the system in the event of the failure of one or more components.</span></p>
<p><span>High availability (HA) is a component of a technology system that eliminates single points of failure to ensure continuous operations or uptime for an extended period. High Availability ensures your systems, databases, and applications operate when and as needed.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<p><span>What is a split-brain situation?</span></p>
<blockquote>
<p><span>In this error scenario, the communication link fails between the nodes, and both nodes believe that they are the primary node. While primary, each node permits Write operations, without those operations being propagated to the peer node. This leads inconsistent storage in each node.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<p><span>What are the advantages and disadvantages of clustered filesystems?</span></p>
<blockquote>
<p><span>A clustered file system leverages multiple physical storage servers which simultaneously mount the file system so that it can be accessed and managed as one single logical system.</span><br>
<span>+</span></p>
<ol>
<li><span>Scalability</span></li>
<li><span>If a server in the cluster needs any maintenance, you can do it by stopping it while handing the load over to other servers.</span></li>
<li><span>Among high availability options, clustering takes a special place since it is reliable and easy to configure.</span></li>
</ol>
<p><span>–</span></p>
<ol>
<li><span>The cost is high. Being not cost-effective is the main disadvantage of this particular design.</span></li>
<li><span>Since clustering needs more servers and hardware to establish one, monitoring and maintenance are hard. Thus increasing the infrastructure.</span></li>
</ol>
</blockquote>
</blockquote><hr><center>
<h2 id="Section-2---Backup" data-id="Section-2---Backup"><a class="anchor hidden-xs" href="#Section-2---Backup" title="Section-2---Backup"><span class="octicon octicon-link"></span></a><span>Section 2 - Backup</span></h2>
<hr>
</center><h2 id="Task-1---Configuration-amp-Testing" data-id="Task-1---Configuration-amp-Testing"><a class="anchor hidden-xs" href="#Task-1---Configuration-amp-Testing" title="Task-1---Configuration-amp-Testing"><span class="octicon octicon-link"></span></a><span>Task 1 - Configuration &amp; Testing</span></h2><div class="alert alert-success">
<ol>
<li><span>Choose any tool from the list below:</span></li>
</ol>
<ul>
<li><span>Borg</span></li>
<li><span>restic</span></li>
<li><span>rsync</span></li>
</ul>
<ol start="2">
<li><span>Create 2 VMs (server and client), install and configure OS (please check the list of supported OS for your solution).</span></li>
<li><span>Configure your solution: install necessary packets, edit the configuration.</span></li>
<li><span>Create a repo on the backup server which will be used to store your backups. </span><strong><span>Bonus</span></strong><span>: configure an encrypted repo</span></li>
<li><span>Make a backup of </span><strong><span>/home</span></strong><span> directory (create some files and directories before backuping) of your client. Don’t forget to make a verification of backup (some solutions provide an embedded option to verify backups). If there is no embedded option to verify backups try to make a verification on your own.</span></li>
<li><span>Then damage your client’s /home/ directory (encrypt it or forcibly remove) and restore from backup. Has anything changed with the files after restoring? Can you see and edit them?</span></li>
</ol>
</div><p><span>I chose </span><strong><span>Borg</span></strong><span> as my backup solution. I created the network topology as shown in Figure 15.</span></p><center>
<p><img src="https://i.imgur.com/pREF2kM.png" alt="" loading="lazy"><br>
<span>Figure 15 - Network topology</span></p>
</center><p><span>on both server and client I install Borg using the command </span><code>sudo apt install borgbackup</code><span>.</span></p><p><span>On the backup server, I created a new user </span><code>sudo useradd -m borg</code><span>.</span></p><p><span>Then I created a directory on the server to house backups:</span></p><pre><code>sudo mkdir /mnt/backups
sudo chown borg:borg /mnt/backup/
sudo chmod 0750 /mnt/backups
</code></pre><p><span>I generated an ssh key using the command </span><code>ssh-keygen -t ed25519</code><span> and copied it to the backup server using the command </span><code>ssh-copy-id borg@10.1.1.85</code><span>.</span></p><p><span>Then I ssh to the backup server using the command </span><code>ssh borg@10.1.1.85</code><span> and create a directory for the client’s backup:</span></p><pre><code>mkdir /mnt/backup/client
chmod 0750 /mnt/backup/client
exit
</code></pre><p><span>Next, let’s initialize the created directory on the backup server via the borg init command: </span><code>borg init --encryption=keyfile borg@10.1.1.85:/mnt/backup/client</code><span> (Figure 16).</span></p><center>
<p><img src="https://i.imgur.com/zya9nia.png" alt="" loading="lazy"><br>
<span>Figure 16 - borg init</span></p>
</center><p><span>To make a backup I created the script (Figure 17).</span></p><center>
<p><img src="https://i.imgur.com/FDHWyIV.png" alt="" loading="lazy"><br>
<span>Figure 17 - script for backup</span></p>
</center><p><span>It will create a backup of </span><strong><span>/home</span></strong><span> directory. But before running it, I created some files in the </span><strong><span>/home/ubuntu</span></strong><span> directory (Figure 18).</span></p><center>
<p><img src="https://i.imgur.com/0OLzB9S.png" alt="" loading="lazy"><br>
<span>Figure 18 - Created files</span></p>
</center><p><span>At last, I run the script using </span><code>sudo sh ./backup.sh</code><span> (Figure 19).</span></p><center>
<p><img src="https://i.imgur.com/38IKf3t.png" alt="" loading="lazy"><br>
<span>Figure 19 - backup is created</span></p>
</center><p><span>To use this backup i will need key - </span><code>/root/.config/borg/keys/10_1_1_85__mnt_backup_client</code><span>.</span></p><p><span>I checked the backup list as shown in Figure 20.</span></p><center>
<p><img src="https://i.imgur.com/8UhoUqw.png" alt="" loading="lazy"><br>
<span>Figure 20 - Backup list</span></p>
</center><p><span>My backup is </span><strong><span>client-2022-02-26</span></strong><span>. First, I checked the backup using the command - </span><code>ssudo borg check --verify-data borg@10.1.1.85:/mnt/backup/client::client-2022-02-26</code><span>.</span><br>
<span>After that, I deleted created files and then extract it using the command </span><code>sudo borg extract borg@10.1.1.85:/mnt/backup/client::client-2022-02-26</code><span> to </span><strong><span>/mnt</span></strong><span> (Figure 21).</span></p><center>
<p><img src="https://i.imgur.com/DrZa5Vp.png" alt="" loading="lazy"><br>
<span>Figure 21 - Backup</span></p>
</center><p><span>Ok, at first glance files are absolutely identical (according to command ls -la). Also, there is no problem with accessing or editing files.</span></p><hr><h2 id="Task-2---Questions" data-id="Task-2---Questions"><a class="anchor hidden-xs" href="#Task-2---Questions" title="Task-2---Questions"><span class="octicon octicon-link"></span></a><span>Task 2 - Questions</span></h2><hr><blockquote>
<ol>
<li><span>When and how often do you need to verify your backups?</span></li>
</ol>
<blockquote>
<p><span>I think that backup should be verified at least once a month. Also, it should be verified after creation and manipulation with a backup server.</span></p>
</blockquote>
</blockquote><hr><blockquote>
<ol start="2">
<li><span>Backup rotations schemes, what are they? Are they available in your solution?</span></li>
</ol>
<blockquote>
<p><span>A backup rotation scheme is a system for managing your backup storage media. Example - First in - First out or Grandfather-Father-Son. I does not include it in my solution. To do so, I need to modify my script as shown in Figure 22.</span></p>
</blockquote>
</blockquote><center>
<p><img src="https://i.imgur.com/1q7tROh.png" alt="" loading="lazy"><br>
<span>Figure 22 - backup script with Grandfather-Father-Son backup rotations schemes</span></p>
</center><blockquote>
<blockquote>
<p><span>To use this kind of solutions, the script must be used with cron jobs, so it will work automatically.</span></p>
</blockquote>
</blockquote><hr><h2 id="References" data-id="References"><a class="anchor hidden-xs" href="#References" title="References"><span class="octicon octicon-link"></span></a><span>References</span></h2><ol>
<li><a href="https://www.ibm.com/cloud/blog/object-vs-file-vs-block-storage" target="_blank" rel="noopener"><span>Object vs. File vs. Block Storage: What’s the Difference?</span></a></li>
<li><a href="https://www.redhat.com/en/topics/data-storage/file-block-object-storage" target="_blank" rel="noopener"><span>File storage, block storage, or object storage?</span></a></li>
<li><a href="https://www.theurbanpenguin.com/installing-drbd-sds-linbit-ubuntu-ppa/" target="_blank" rel="noopener"><span>Installing DRBD-SDS From The LINBIT Ubuntu PPA</span></a></li>
<li><a href="https://habr.com/ru/company/otus/blog/509710/" target="_blank" rel="noopener"><span>Configuring DRBD for storage replication</span></a></li>
<li><a href="https://help.ubuntu.ru/wiki/%D1%80%D1%83%D0%BA%D0%BE%D0%B2%D0%BE%D0%B4%D1%81%D1%82%D0%B2%D0%BE_%D0%BF%D0%BE_ubuntu_server/%D0%BA%D0%BB%D0%B0%D1%81%D1%82%D0%B5%D1%80%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F/drbd" target="_blank" rel="noopener"><span>Ubuntu Manual. DRBD</span></a></li>
<li><a href="https://github.com/LINBIT/drbd" target="_blank" rel="noopener"><span> LINBIT/drbd </span></a></li>
<li><a href="https://linbit.com/drbd-user-guide/drbd-guide-9_0-en/" target="_blank" rel="noopener"><span> The DRBD9 User’s Guide </span></a></li>
<li><a href="https://habr.com/ru/post/445612/" target="_blank" rel="noopener"><span>drbd+ocfs2</span></a></li>
<li><a href="https://www.tecmint.com/what-is-clustering-and-advantages-disadvantages-of-clustering-in-linux/" target="_blank" rel="noopener"><span>Advantages/Disadvantages of Clustering</span></a></li>
<li><a href="https://www.liquidweb.com/blog/fault-tolerance/" target="_blank" rel="noopener"><span>What Is Fault Tolerance and Why It Differs From High Availability</span></a></li>
<li><a href="https://developer.ibm.com/tutorials/l-drbd/" target="_blank" rel="noopener"><span>HA with the DRBD</span></a></li>
</ol></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li><a href="#LS-Lab-6---Fault-Tolerant-and-High-Available-Storage-amp-Backup" title="LS Lab 6 - Fault Tolerant and High Available Storage &amp; Backup">LS Lab 6 - Fault Tolerant and High Available Storage &amp; Backup</a><ul class="nav">
<li><a href="#Task-1---Take-a-pick" title="Task 1 - Take a pick">Task 1 - Take a pick</a></li>
<li><a href="#Task-2---Fault-tolerant-setup" title="Task 2 - Fault tolerant setup">Task 2 - Fault tolerant setup</a></li>
<li><a href="#Task-3---High-Available-setup" title="Task 3 - High Available setup">Task 3 - High Available setup</a></li>
</ul>
</li>
<li><a href="#Task-4---Questions" title="Task 4 - Questions">Task 4 - Questions</a><ul class="nav">
<li><a href="#Task-1---Configuration-amp-Testing" title="Task 1 - Configuration &amp; Testing">Task 1 - Configuration &amp; Testing</a></li>
<li><a href="#Task-2---Questions" title="Task 2 - Questions">Task 2 - Questions</a></li>
<li><a href="#References" title="References">References</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li><a href="#LS-Lab-6---Fault-Tolerant-and-High-Available-Storage-amp-Backup" title="LS Lab 6 - Fault Tolerant and High Available Storage &amp; Backup">LS Lab 6 - Fault Tolerant and High Available Storage &amp; Backup</a><ul class="nav">
<li><a href="#Task-1---Take-a-pick" title="Task 1 - Take a pick">Task 1 - Take a pick</a></li>
<li><a href="#Task-2---Fault-tolerant-setup" title="Task 2 - Fault tolerant setup">Task 2 - Fault tolerant setup</a></li>
<li><a href="#Task-3---High-Available-setup" title="Task 3 - High Available setup">Task 3 - High Available setup</a></li>
</ul>
</li>
<li><a href="#Task-4---Questions" title="Task 4 - Questions">Task 4 - Questions</a><ul class="nav">
<li><a href="#Task-1---Configuration-amp-Testing" title="Task 1 - Configuration &amp; Testing">Task 1 - Configuration &amp; Testing</a></li>
<li><a href="#Task-2---Questions" title="Task 2 - Questions">Task 2 - Questions</a></li>
<li><a href="#References" title="References">References</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
